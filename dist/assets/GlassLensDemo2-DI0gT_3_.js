var e=Object.defineProperty,n=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(n,t,r)=>t in n?e(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,a=(e,n)=>{for(var t in n||(n={}))i.call(n,t)&&s(e,t,n[t]);if(r)for(var t of r(n))o.call(n,t)&&s(e,t,n[t]);return e},l=(e,r)=>n(e,t(r));import{r as c,j as d}from"./index-ZdoUcc_X.js";import{m as u,e as h,u as f,a as p,b as m,c as g,d as b,i as v,E as w,B as x,f as y,T as N,g as k,V as C,h as S}from"./events-dc44c1b8.esm--BGmuA_o.js";function j(e,n){let t;return(...r)=>{window.clearTimeout(t),t=window.setTimeout(()=>e(...r),n)}}function R({debounce:e,scroll:n,polyfill:t,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||("undefined"==typeof window?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,s]=c.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=c.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o,orientationHandler:null}),l=e?"number"==typeof e?e:e.scroll:null,d=e?"number"==typeof e?e:e.resize:null,u=c.useRef(!1);c.useEffect(()=>(u.current=!0,()=>{u.current=!1}));const[h,f,p]=c.useMemo(()=>{const e=()=>{if(!a.current.element)return;const{left:e,top:n,width:t,height:i,bottom:o,right:l,x:c,y:d}=a.current.element.getBoundingClientRect(),h={left:e,top:n,width:t,height:i,bottom:o,right:l,x:c,y:d};a.current.element instanceof HTMLElement&&r&&(h.height=a.current.element.offsetHeight,h.width=a.current.element.offsetWidth),Object.freeze(h),u.current&&!D(a.current.lastBounds,h)&&s(a.current.lastBounds=h)};return[e,d?j(e,d):e,l?j(e,l):e]},[s,r,l,d]);function m(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",p,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function g(){a.current.element&&(a.current.resizeObserver=new i(p),a.current.resizeObserver.observe(a.current.element),n&&a.current.scrollContainers&&a.current.scrollContainers.forEach(e=>e.addEventListener("scroll",p,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{p()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}return function(e,n){c.useEffect(()=>{if(n){const n=e;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",n,!0)}}},[e,n])}(p,!!n),function(e){c.useEffect(()=>{const n=e;return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[e])}(f),c.useEffect(()=>{m(),g()},[n,p,f]),c.useEffect(()=>m,[]),[e=>{!e||e===a.current.element||(m(),a.current.element=e,a.current.scrollContainers=z(e),g())},o,h]}function z(e){const n=[];if(!e||e===document.body)return n;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(e);return[t,r,i].some(e=>"auto"===e||"scroll"===e)&&n.push(e),[...n,...z(e.parentElement)]}const L=["x","y","top","bottom","left","right","width","height"],D=(e,n)=>L.every(t=>e[t]===n[t]);function P(e){var n=e,{ref:t,children:s,fallback:u,resize:k,style:C,gl:S,events:j=b,eventSource:z,eventPrefix:L,shadows:D,linear:P,flat:O,legacy:U,orthographic:F,frameloop:M,dpr:T,performance:E,raycaster:G,camera:_,scene:B,onPointerMissed:H,onCreated:V}=n,X=((e,n)=>{var t={};for(var s in e)i.call(e,s)&&n.indexOf(s)<0&&(t[s]=e[s]);if(null!=e&&r)for(var s of r(e))n.indexOf(s)<0&&o.call(e,s)&&(t[s]=e[s]);return t})(n,["ref","children","fallback","resize","style","gl","events","eventSource","eventPrefix","shadows","linear","flat","legacy","orthographic","frameloop","dpr","performance","raycaster","camera","scene","onPointerMissed","onCreated"]);c.useMemo(()=>h(N),[]);const Y=f(),[q,A]=R(a({scroll:!0,debounce:{scroll:50,resize:0}},k)),I=c.useRef(null),Q=c.useRef(null);c.useImperativeHandle(t,()=>I.current);const W=p(H),[J,K]=c.useState(!1),[Z,$]=c.useState(!1);if(J)throw J;if(Z)throw Z;const ee=c.useRef(null);m(()=>{const e=I.current;if(A.width>0&&A.height>0&&e){function n(){return e=this,n=function*(){yield ee.current.configure({gl:S,scene:B,events:j,shadows:D,linear:P,flat:O,legacy:U,orthographic:F,frameloop:M,dpr:T,performance:E,raycaster:G,camera:_,size:A,onPointerMissed:(...e)=>null==W.current?void 0:W.current(...e),onCreated:e=>{null==e.events.connect||e.events.connect(z?v(z)?z.current:z:Q.current),L&&e.setEvents({compute:(e,n)=>{const t=e[L+"X"],r=e[L+"Y"];n.pointer.set(t/n.size.width*2-1,-r/n.size.height*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)}}),null==V||V(e)}}),ee.current.render(d.jsx(Y,{children:d.jsx(w,{set:$,children:d.jsx(c.Suspense,{fallback:d.jsx(x,{set:K}),children:null!=s?s:null})})}))},new Promise((t,r)=>{var i=e=>{try{s(n.next(e))}catch(t){r(t)}},o=e=>{try{s(n.throw(e))}catch(t){r(t)}},s=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,o);s((n=n.apply(e,null)).next())});var e,n}ee.current||(ee.current=g(e)),n()}}),c.useEffect(()=>{const e=I.current;if(e)return()=>y(e)},[]);const ne=z?"none":"auto";return d.jsx("div",l(a({ref:Q,style:a({position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ne},C)},X),{children:d.jsx("div",{ref:q,style:{width:"100%",height:"100%"},children:d.jsx("canvas",{ref:I,style:{display:"block"},children:u})})}))}function O(e){return d.jsx(u,{children:d.jsx(P,a({},e))})}function U({texture:e,lensCenter:n,lensRadius:t,refractStrength:r,distortion:i}){const o=c.useRef(),s=c.useRef();return S(()=>{s.current&&(s.current.uniforms.uLensCenter.value=n,s.current.uniforms.uLensRadius.value=t,s.current.uniforms.uRefractStrength.value=r,s.current.uniforms.uDistortion.value=i)}),d.jsxs("mesh",{ref:o,position:[0,0,0],children:[d.jsx("planeGeometry",{args:[2,2]}),d.jsx("shaderMaterial",{ref:s,uniforms:{uTexture:{value:e},uLensCenter:{value:n},uLensRadius:{value:t},uRefractStrength:{value:r},uDistortion:{value:i}},vertexShader:"\n          varying vec2 vUv;\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          }\n        ",fragmentShader:"\n  uniform sampler2D uTexture;\n  uniform vec2 uLensCenter;\n  uniform float uLensRadius;\n  uniform float uRefractStrength;\n  uniform float uDistortion;\n  varying vec2 vUv;\n\n  void main() {\n    vec2 toCenter = vUv - uLensCenter;\n    float dist = length(toCenter);\n    if (dist < uLensRadius) {\n      float effect = (uLensRadius - dist) / uLensRadius;\n      effect = pow(effect, uDistortion);\n      vec2 refractUv = vUv + normalize(toCenter) * effect * uRefractStrength * 0.05;\n      gl_FragColor = texture2D(uTexture, refractUv);\n    } else {\n      gl_FragColor = texture2D(uTexture, vUv);\n    }\n  }\n"})]})}function F(){const[e,n]=c.useState({x:.5,y:.5,radius:.18,strength:1.2,distortion:1.5}),[t,r]=c.useState(!0),i=c.useRef(!1),o=(new k).load("https://images.unsplash.com/photo-1506905925346-21bda4d32df4?auto=format&fit=crop&w=800&q=80"),s=(e,t)=>{n(n=>l(a({},n),{[e]:t}))},u={subtle:{radius:.12,strength:.8,distortion:1.2},medium:{radius:.18,strength:1.2,distortion:1.5},strong:{radius:.25,strength:2,distortion:2},extreme:{radius:.35,strength:3,distortion:3}};return d.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-pink-900 to-red-900 p-4",children:[d.jsxs("div",{className:"max-w-6xl mx-auto",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Glass Lens Effect Demo 2"}),d.jsx("p",{className:"text-gray-300 text-lg",children:"Interactive WebGL refraction with real-time controls"})]}),d.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[d.jsx("div",{className:"lg:col-span-2",children:d.jsxs("div",{style:{},children:[d.jsx(O,{orthographic:!0,camera:{zoom:1,position:[0,0,10]},onPointerDown:()=>i.current=!0,onPointerUp:()=>i.current=!1,onPointerMove:function(e){if(!i.current)return;const{left:t,top:r,width:o,height:s}=e.target.getBoundingClientRect(),c=(e.clientX-t)/o,d=1-(e.clientY-r)/s;n(e=>l(a({},e),{x:c,y:d}))},children:d.jsx(U,{texture:o,lensCenter:new C(e.x,e.y),lensRadius:e.radius,refractStrength:e.strength,distortion:e.distortion})}),d.jsxs("div",{style:{position:"absolute",top:10,left:10,color:"#fff",background:"rgba(0,0,0,0.7)",padding:"12px 16px",borderRadius:8,fontSize:14,backdropFilter:"blur(10px)"},children:[d.jsx("b",{children:"ðŸŽ¯ Drag to move lens"}),d.jsx("br",{}),d.jsx("span",{className:"text-gray-300",children:"Adjust settings on the right"})]}),d.jsxs("div",{style:{position:"absolute",bottom:10,right:10,color:"#fff",background:"rgba(0,0,0,0.7)",padding:"12px 16px",borderRadius:8,fontSize:12,backdropFilter:"blur(10px)",fontFamily:"monospace"},children:[d.jsxs("div",{children:["Radius: ",e.radius.toFixed(3)]}),d.jsxs("div",{children:["Strength: ",e.strength.toFixed(2)]}),d.jsxs("div",{children:["Distortion: ",e.distortion.toFixed(2)]})]})]})}),d.jsx("div",{className:"lg:col-span-1",children:d.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-bold text-white",children:"Controls"}),d.jsx("button",{onClick:()=>r(!t),className:"text-gray-300 hover:text-white transition-colors",children:t?"âˆ’":"+"})]}),t&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-white font-semibold mb-3",children:"Quick Presets"}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(u).map(([e,t])=>d.jsx("button",{onClick:()=>(e=>{const t=u[e];n(e=>a(a({},e),t))})(e),className:"px-3 py-2 bg-pink-600/30 hover:bg-pink-600/50 text-white rounded-lg text-sm transition-colors border border-pink-500/30",children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-white font-medium mb-2",children:["Lens Radius: ",e.radius.toFixed(3)]}),d.jsx("input",{type:"range",min:"0.05",max:"0.5",step:"0.01",value:e.radius,onChange:e=>s("radius",parseFloat(e.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"}),d.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[d.jsx("span",{children:"Small"}),d.jsx("span",{children:"Large"})]})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-white font-medium mb-2",children:["Refraction Strength: ",e.strength.toFixed(2)]}),d.jsx("input",{type:"range",min:"0.1",max:"5.0",step:"0.1",value:e.strength,onChange:e=>s("strength",parseFloat(e.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"}),d.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[d.jsx("span",{children:"Subtle"}),d.jsx("span",{children:"Strong"})]})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-white font-medium mb-2",children:["Distortion: ",e.distortion.toFixed(2)]}),d.jsx("input",{type:"range",min:"0.5",max:"4.0",step:"0.1",value:e.distortion,onChange:e=>s("distortion",parseFloat(e.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider"}),d.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[d.jsx("span",{children:"Linear"}),d.jsx("span",{children:"Curved"})]})]}),d.jsx("button",{onClick:()=>{n({x:.5,y:.5,radius:.18,strength:1.2,distortion:1.5})},className:"w-full px-4 py-3 bg-red-600/30 hover:bg-red-600/50 text-white rounded-lg transition-colors border border-red-500/30 font-medium",children:"Reset to Default"}),d.jsxs("div",{className:"bg-pink-900/30 border border-pink-500/30 rounded-lg p-4",children:[d.jsx("h4",{className:"text-pink-300 font-semibold mb-2",children:"ðŸ’¡ Tips"}),d.jsxs("ul",{className:"text-pink-200 text-sm space-y-1",children:[d.jsx("li",{children:"â€¢ Start with presets, then fine-tune"}),d.jsx("li",{children:"â€¢ Radius affects lens size"}),d.jsx("li",{children:"â€¢ Strength controls refraction intensity"}),d.jsx("li",{children:"â€¢ Distortion changes the curve shape"})]})]})]})]})})]})]}),d.jsx("style",{jsx:!0,children:"\n        .slider::-webkit-slider-thumb {\n          appearance: none;\n          height: 20px;\n          width: 20px;\n          border-radius: 50%;\n          background: linear-gradient(45deg, #ec4899, #f472b6);\n          cursor: pointer;\n          border: 2px solid white;\n        }\n        \n        .slider::-moz-range-thumb {\n          height: 20px;\n          width: 20px;\n          border-radius: 50%;\n          background: linear-gradient(45deg, #ec4899, #f472b6);\n          cursor: pointer;\n          border: 2px solid white;\n        }\n      "})]})}export{F as default};
